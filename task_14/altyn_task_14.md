# Задача о максимальном потоке.
**Постановка задачи:**
1. Построить сеть с указанием пропускной способности дуг.
2. Построить остаточную сеть.
3. Определить максимальный поток методом поиска увеличивающих путей в остаточной сети.
4. Проверить величину максимального потока через поиск минимальной пропускной способности разрезов сети.
5. Оформить решение задачи по шагам с подробными комментариями, таблицами и диаграммами.
6. В ответе указать максимальную величину потока и сеть с указанием соответствующих локальных потоков.
### Вариант 1:

|          Дуги          | sa | sb | ad | ab | bc | cd | bt | dt | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 8  | 9  | 7  | 5  | 7  | 5  | 6  | 6  | 6  |

## Решение
### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг.
```mermaid
graph LR
    s-->|8|a
    s-->|9|b
    a-->|5|b
    b-->|6|t
    a-->|7|d
    d-->|6|t
    c-->|5|d
    b-->|7|c
    c-->|6|t
```
Построим остаточную сеть. Так как изначально поток в сети не задан, все дуги сети являются пустыми (локальный поток равен нулю), соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности. 
```mermaid
graph RL
    a-.->|8|s
    b-.->|9|s
    b-.->|5|a
    t-.->|6|b
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    c-.->|7|b
    t-.->|6|c
```
### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> c -> b -> s. Минимальный вес дуг на этом пути равен 6.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph RL
    a-.->|8|s
    b-.->|3|s
    s-->|6|b
    b-.->|5|a
    t-.->|6|b
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```

Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 

```mermaid
graph LR
    s-->|"(0,8)"|a
    s-->|"(6,9)"|b
    a-->|"(0,5)"|b
    b-->|"(0,6)"|t
    a-->|"(0,7)"|d
    d-->|"(0,6)"|t
    c-->|"(0,5)"|d
    b-->|"(6,7)"|c
    c-->|"(6,6)"|t
```
### 3. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph RL
    a-.->|8|s
    b-.->|3|s
    s-->|6|b
    b-.->|5|a
    t-.->|6|b
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```

В остаточной сети найден увеличивающий путь t -> b ->  s. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph RL
    a-.->|8|s
    s-->|9|b
    b-.->|5|a
    t-.->|3|b
    b-->|3|t
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(0,8)"|a
    s-->|"(9,9)"|b
    a-->|"(0,5)"|b
    b-->|"(3,6)"|t
    a-->|"(0,7)"|d
    d-->|"(0,6)"|t
    c-->|"(0,5)"|d
    b-->|"(6,7)"|c
    c-->|"(6,6)"|t
```
### 4. Продолжим поиск увеличивающего пути в остаточной сети

```mermaid
graph RL
    a-.->|8|s
    s-->|9|b
    b-.->|5|a
    t-.->|3|b
    b-->|3|t
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```

В остаточной сети найден увеличивающий путь t -> b -> a -> s. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    a-.->|5|s
    s-->|3|a
    s-->|9|b
    b-.->|2|a
    a-->|3|b
    b-->|6|t
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(3,8)"|a
    s-->|"(9,9)"|b
    a-->|"(3,5)"|b
    b-->|"(6,6)"|t
    a-->|"(0,7)"|d
    d-->|"(0,6)"|t
    c-->|"(0,5)"|d
    b-->|"(6,7)"|c
    c-->|"(6,6)"|t
```
### 5. Продолжим поиск увеличивающего пути в остаточной сети
```mermaid
graph RL
    a-.->|5|s
    s-->|3|a
    s-->|9|b
    b-.->|2|a
    a-->|3|b
    b-->|6|t
    d-.->|7|a
    t-.->|6|d
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```
В остаточной сети найден увеличивающий путь t -> d -> a -> s. Минимальный вес дуг на этом пути равен 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph RL
    s-->|8|a
    s-->|9|b
    b-.->|3|a
    a-->|2|b
    t-.->|1|b
    b-->|5|t
    d-.->|2|a
    a-->|5|d
    d-->|6|t
    d-.->|5|c
    b-->|6|c
    c-.->|1|b
    c-->|6|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(8,8)"|a
    s-->|"(9,9)"|b
    a-->|"(2,5)"|b
    b-->|"(5,6)"|t
    a-->|"(6,7)"|d
    d-->|"(6,6)"|t
    c-->|"(0,5)"|d
    b-->|"(6,7)"|c
    c-->|"(6,6)"|t
```
### 6. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 17 является максимальным для данной сети.
### 6. Проверим значение максимального потока перебором всех разрезов сети.
Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.

Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.

Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.

Для сети из 6 вершин нужно найти 2<sup>6 - 2</sup> = 2<sup>4</sup> = 16 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, d, t    |           8 + 9 = 17           |            |
| 2 | s, a                            | b, c, d, t       |         9 + 5 + 7 = 21         |
| 3 | s, b                            | a, c, d, t       |         8 + 7 + 6 = 21         |
| 4 | s, c                            | a, b, d, t       |         8 + 9 + 6 + 5 = 28         |             |
| 5 | s, d                            | a, b, c, t       |         8 + 9 + 6 = 23         |             |
| 6 | s, a, b                         | c, d, t          |         7 + 7 + 6 = 20         |
| 7 | s, a, c                         | b, d, t          |         9 + 5 + 5 + 6 = 22         |
| 8 | s, a, d                         | b, c, t          |         9 + 5 + 6 = 20         |            |
| 9 | s, b, c                      | a, d, t             |           8 + 6 + 6 = 20           |
| 10 | s, b, d                               | a, c, t    |           8 + 7 + 6 = 21           |            |
| 11 | s, c, d                            | a, b, t       |         8 + 9 + 6 + 6 = 29         |
| 12 | s, b, c, d                            | a, t       |         8 + 6 + 6 + 6 = 26         |
| 13 | s, a, c, d                           | b, t       |         9 + 6 + 6 + 6 = 27         |             |
| 14 | s, a, b, d                         | c, t          |         7 + 6 + 6 = 19         |
| 15 | s, a, b, c                         | d, t          |         7 + 6 + 6 = 19         |
| 16 | s, a, b, c, d                        | t          |         6 + 6 + 6 = 18         |            |


Минимальная пропускная способность разреза равна 17 ( {s} / {a, b, c, d, t} ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 17, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|"(8,8)"|a
    s-->|"(9,9)"|b
    a-->|"(2,5)"|b
    b-->|"(5,6)"|t
    a-->|"(6,7)"|d
    d-->|"(6,6)"|t
    c-->|"(0,5)"|d
    b-->|"(6,7)"|c
    c-->|"(6,6)"|t
```
