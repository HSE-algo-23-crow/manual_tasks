
# Задание №14
# Задача о максимальном потоке.
## Постановка задачи
1. Дана сеть (взвешенный ориентированный граф) с источником s и стоком t.
2. Для каждой дуги определена пропускная способность.
3. Необходимо найти максимальный поток для указанной сети. 

## Решение
### Вариант 8:
Пропускная способность дуг сети указана в таблице.

|          Дуги          | sb | sa | bt | ba | bc | ac | at | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 11 | 8  | 5  | 5  | 3  | 3  | 6  | 9  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг.

```mermaid
graph LR
    s-->|0,8|a
    s-->|0,11|b
    b-->|0,5|a
    a-->|0,3|c
    a-->|0,6|t
    b-->|0,3|c
    c-->|0,9|t
    b-->|0,5|t
```

Найдем начальный поток:

```mermaid
graph LR
    s-->|11|b
    b-->|5|a
    a-->|3|c
    c-->|9|t
```
Пропускная способность F=3.

### 2. Построим остаточную сеть, соответствующую взятому на 1 шаге потоку.

```mermaid
graph LR
    a-.->|8|s
    s-->|3|b
    b-.->|8|s
    b-->|3|a
    a-.->|2|b
    a-->|3|c
    t-.->|6|a
    c-.->|3|b
    c-->|3|t
    t-.->|6|c
    t-.->|5|b
```

### 3. В остаточной сети ищем увеличивающий путь из t в s.
Возьмем путь: 
```mermaid
graph LR
    b-.->|8|s
    t-.->|5|b
```
Минимальный вес дуги равен 5. Далее необходимо: 
а) уменьшить веса дуг t->b, b->s на 5;  
б) увеличить веса дуг s->b, b->t на 5.  
Таким образом, новая пропускная способность F=3+5=8. Получаем новую остаточную сеть.

```mermaid
graph LR
    a-.->|8|s
    s-->|8|b
    b-.->|3|s
    b-->|3|a
    a-.->|2|b
    a-->|3|c
    t-.->|6|a
    c-.->|3|b
    c-->|3|t
    t-.->|6|c
    b-->|5|t
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети.
Возьмем путь:
```mermaid
graph LR
    a-.->|8|s
    t-.->|6|a
```
Минимальный вес дуги равен 6. Далее необходимо: 
а) уменьшить веса дуг t->a, a->s на 6;  
б) увеличить веса дуг s->a, a->t на 5.  
Таким образом, новая пропускная способность F=8+6=14. Получаем новую остаточную сеть.
```mermaid
graph LR
    a-.->|2|s
    s-->|6|a
    s-->|8|b
    b-.->|3|s
    b-->|3|a
    a-.->|2|b
    a-->|3|c
    a-->|6|t
    c-.->|3|b
    c-->|3|t
    t-.->|6|c
    b-->|5|t
```

### 5. Продолжим поиск увеличивающего пути в остаточной сети.
Возьмем путь:
```mermaid
graph LR
    t-.->|6|c
    c-.->|3|b
    b-.->|3|s
```
Минимальный вес дуги равен 3. Далее необходимо: 
а) уменьшить веса дуг t->c, c->b, b->s на 3;  
б) увеличить веса дуг s->b, b->c, c->t на 3.  
Таким образом, новая пропускная способность F=14+3=17. Получаем новую остаточную сеть.
```mermaid
graph LR
    a-.->|2|s
    s-->|6|a
    s-->|11|b
    b-->|3|a
    a-.->|2|b
    a-->|3|c
    a-->|6|t
    b-->|3|c
    c-->|6|t
    t-.->|3|c
    b-->|5|t
```
В последней полученной остаточной сети найти увеличивающий путь из t в s не представляется возможным. Cледовательно, алгоритм завершил работу и найденный поток величиной 17 является максимальным для данной сети.

### 6. Проверим значение максимального потока перебором всех разрезов сети.
Найдем величину максимального потока через поиск минимальной пропускной способности резервов сети.

Для нахождения пропускных способностей резервов сети используем изначально данную сеть и учитываем максимальную пропускную способность каждой дуги. 

Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.

Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.

Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.

Для сети из 5 вершин нужно найти 2<sup>5 - 2</sup> = 2<sup>3</sup> = 8 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, t    |           11 + 8 = 19           |
|   | **s + одна вершина из a, b, c** |               |                                |
| 2 | s, a                            | b, c, t       |         11 + 3 + 6 = 20         |
| 3 | s, b                            | a, c, t       |         8 + 5 + 3 + 5 = 21         |
| 4 | s, c                            | a, b, t       |         8 + 11 + 9 = 28         |
|   | **s + пара вершин из a, b, c**  |               |                                |
| 5 | s, a, b                         | c, t          |         6 + 3 + 3 + 5 = 17         |
| 6 | s, a, c                         | b, t          |         6 + 9 + 11 = 26         |
| 7 | s, b, c                         | a, t          |         8 + 5 + 5 + 9 = 27         |
|   | **s + три вершины из a, b, c**  |               |                                |
| 8 | s, a, b, c                      | t             |           6 + 9 + 5 = 20           |

Минимальная пропускная способность разреза равна 17 ( {s, a, b} / {c, t} ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 17, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|6,8|a
    s-->|11,11|b
    b-->|3,5|a
    a-->|3,3|c
    a-->|6,6|t
    b-->|3,3|c
    c-->|6,9|t
    b-->|5,5|t
```

